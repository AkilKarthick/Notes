create a table

create table employee (
  emp_id int primary key,
  emp_name varchar(100),
  dept_id int,
  salary DECIMAL(10,2)
);

insert query:

insert into employee(emp_id,emp_name,dep_id,salary) 
values(1,'akil',1,1000.00)

UPDATE & DELETE

  UPDATE employee SET salary = salary+500 WHERE emp_id =1;
  DELETE from employee where emp_id =2;

JOINS:

wer have two tables
-employee(emp_id, emp_name, dept_id, salary)
-department(dept_id, dept_name)

  INNER JOIN

select e.emp_id, d.dep_id
  from employee e 
  INNER JOIN department d
  on e.dep_id = d.dep_id;

1. find top 3 highest salary
  select salary
  from eployee
  order by sal desc
  limit 3;

2. count of emp in each dep

  select dep_id, count(*) as emp_count
  from employee
  group by depp_id
  
4) Find employees who earn more than department average

select
from employee e



Q1. Get highest paid employee per department.?
    //wrond approach
      select *, max(salary) as high_paid_emp 
      from employee 
      group by dep_id
    
    //correct 
      select e.*
      from employee e
      where e.salary = (select max(salary) 
                        from employee 
                        where dep_id = e.dep_id
    );
    
    we can use window function -modern sql::
    
    select emp_id, emp_name, dep_id, salary
    from ( select e.*, RANK() OVER(parition by dep_id order by salary desc) AS rnk 
    from employee e ) where rnk =1;

----------------------------------------------------------
Q2. Get all employees earning above overall average salary.?
    select *
    from employee e
    where e.salary > (select avg(salary) from employee)

-----------------------------------------------------------------
Q3. List department-wise employee count, sort highest count first.

    select dep_id, count(*) as emp_count
    from employee e
    group by dept_id
    order by emp_coint desc;
-----------------------------------------------
Q4. Find 3rd highest salary (try without LIMIT)?
      select * from employee
      where sal < (select max(salary) from employee 
      where salary < (select max(salary) from employee))
or
      SELECT DISTINCT salary
      FROM employee
      ORDER BY salary DESC
      LIMIT 2,1;   -- 0=1st, 1=2nd, 2=3rd

modern -sql

  select salary
  from ( select salary, DENSE_RANK() OVER(group by salary desc) as rnk
  from employee) x
where rnk =3;
----------------------------------------------------------------------------------
Q5. Display employees in descending salary order, but if salary ties, sort by name.

select * from employee 
order by salary desc, emp_name asc;


q6.Find duplicate employee names in the table.

select  emp_name, count(*) as emp_count
from employee
group by emp_name
having count(*) >1

Q7.delete duplicates but keep only one copy

delete e1
from employee e1 join employee e2 
on e1.emp_name = e2.emp_name
and e1.emp_id > e2.emp_id;

I remove duplicates using a self-join. 
I compare rows with the same name and delete the one with the higher primary key
so that only one original entry remains.â€

-----------------------
Q8: Employees who don't belong to any department

select emp_name
from employee
where dep_id = null  //wrong bcz NULL is not compared using =.

SELECT emp_id, emp_name, dept_id
FROM employee
WHERE dept_id IS NULL;

SELECT e.emp_id, e.emp_name, e.dept_id
FROM employee e
LEFT JOIN department d
       ON e.dept_id = d.dept_id
WHERE d.dept_id IS NULL;
--------------------------
q9>Fetch the highest salary in each department using window functions?

select emp_name, emp_id, dept_id, salary
from ( select e.*, DENSE_RANK() OVER(PARITION BY dept_id ORDER BY salary DESC) AS rnk
from employee e) X
WHERE rnk =1

Q10. Fetch employees who joined in the last 30 days.

  select emp_name
  from employe
  where hiredate > CURRENT_DATE - INTERVAl 30 DAY; //wrong

correct one is?

  select emp_id, emp_name, dept_id, hiredate
  from employee
  where hiredate >= CURENT_DATE - INTERVAL 30 DAYS;


consider you have this table!
sales(order_id, amount, sale_date)

find total sales made in june 2025 means how you solve?

  select sum(amount) as total sale
  from sales
  where sale_date >= '2025-06-01' AND saledate < '2025-07-01'

or 

select 
from sales
where MONTH(sales_date) =6 AND YEAR(sales_date) = 2025

Q11: Nth Highest Salary

select salary
from (select salary,
        DENSE_RANK() OVER (ORDER BY DESC) AS rnk
where rnk = 5

Q12): Self Join Logic?

select e2.emp_name AS employee, e2.emp_name as manager
from employee e1 join employee e2
on e1.emp_id = e2.manager_id

correct answer:
SELECT e2.emp_name AS employee,
       e1.emp_name AS manager
FROM employee e2
LEFT JOIN employee e1
       ON e2.manager_id = e1.emp_id;

Q13:

Show departments where the number of employees is more than 5

  select dep_id, count(*) as emp_count
  from employee
  group by dept_id
  having count(*) >5 ;






